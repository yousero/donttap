function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _iterableToArrayLimit(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var r,a,n=[],o=!0,l=!1;try{for(i=i.call(e);!(o=(r=i.next()).done)&&(n.push(r.value),!t||n.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==i.return||i.return()}finally{if(l)throw a}}return n}}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(i):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(e,t):void 0}}var appDiv=document.getElementById("app"),canvasDiv=document.getElementById("canvas"),healthbarDiv=document.getElementById("healthbar"),ctx=canvasDiv.getContext("2d"),borderColor="#990003",fillColor="#f1f7ff",activeColor="#000107",squareColor="#00BFFF";healthbarDiv.style.backgroundColor=fillColor,healthbarDiv.style.width="0%";var h=4,w=4,bSize=0,cellSize=100,activeCells=3;function refreshCanvas(){cellSize=100,window.innerWidth<446?cellSize=72:window.innerWidth>1024&&(cellSize=128),cellSize=100,canvasDiv.height=h*(cellSize+bSize)+bSize,canvasDiv.width=w*(cellSize+bSize)+bSize}function renderSquare(e,t,i){ctx.fillStyle=i;var r=t*(cellSize+bSize)+bSize,a=e*(cellSize+bSize)+bSize;ctx.fillRect(a,r,cellSize,cellSize)}function render(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:borderColor,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fillColor;ctx.fillStyle=e,ctx.fillRect(0,0,(cellSize+bSize)*h+bSize,(cellSize+bSize)*w+bSize),ctx.fillStyle=t;for(var i=0;i<h;++i)for(var r=0;r<w;++r){var a=i*(cellSize+bSize)+bSize,n=r*(cellSize+bSize)+bSize;ctx.fillRect(n,a,cellSize,cellSize)}}refreshCanvas();var speed=0,clicks=0,misses=0,accuracy=1,breakPoint=4,missStreak=0,state="STOP",clock=0,msToLife=250,clickTime=new Date,hitTime=new Date,startTime=new Date,hpTime=new Date,endTime=new Date;endTime.setSeconds(-120);var clickStamps=[],gameMap=[],infoDiv=document.getElementById("information");function addInfo(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=document.createElement("div");r.classList.add("stats");var a=document.createElement("div");a.classList.add("stats-label"),a.textContent=e,r.appendChild(a);var n=document.createElement("div");n.classList.add("stats-value"),n.textContent=t,r.appendChild(n),i&&(r.title=i),infoDiv.appendChild(r)}function textNumber(e){return tNumber=String(Math.round(100*e)/100),"."==tNumber.slice(-2,-1)&&(tNumber+="0"),"."!=tNumber.slice(-3,-2)&&(tNumber+=".00"),tNumber}function gameover(){if("RUNNING"==state&&(endTime=new Date,state="GAMEOVER",clock=0,healthbarDiv.style.width="0%",render(borderColor,squareColor),clicks)){var e=(endTime-startTime)/1e3;speed=clicks/e,accuracy=clicks?clicks/(clicks+misses):1;var t=Math.floor(e/60);if(t>0){var i=Math.floor(e)%60;i<10&&(i="0"+i),addInfo("time","".concat(t,":").concat(i))}else addInfo("time",textNumber(e)+"s");if(addInfo("clicks",String(clicks)),addInfo("speed",textNumber(speed),"clicks per second"),addInfo("accuracy",textNumber(100*accuracy)+"%",misses+" misses"),infoDiv.classList.remove("hidden"),localStorage){var r=[];if(localStorage.records)try{r=JSON.parse(localStorage.records)}catch(e){delete localStorage.records}r.length>=0&&(r.push([endTime.getTime(),e,clicks,misses].join(";")),localStorage.records=JSON.stringify(r))}}}function run(){if("RUNNING"==state){var e=new Date;if(msClock=endTime-e,msClock<=0)return gameover();if((clock=(e-startTime)/1e3)>0){var t=endTime-hpTime,i=100*msClock/t;healthbarDiv.style.width=i+"%",t>=6e4&&i<=25&&hpTime.setMilliseconds(hpTime.getMilliseconds()+6.5*t/10)}else healthbarDiv.style.width="0%";requestAnimationFrame(run)}}function randomCell(){var e=Math.floor(Math.random()*gameMap.length),t=_slicedToArray(gameMap[e].split("."),2);renderSquare(t[0],t[1],squareColor),gameMap.splice(e,1)}function start(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||!(new Date-endTime<1500)){infoDiv.classList.add("hidden"),infoDiv.innerHTML="",gameMap=[];for(var e=0;e<h;++e)for(var t=0;t<w;++t)gameMap.push("".concat(t,".").concat(e));render();for(var i=0;i<activeCells;++i)randomCell();speed=0,clicks=0,misses=0,missStreak=0,accuracy=1,state="RUNNING",clock=0,msToLife=250,startTime=new Date,hpTime=new Date,(endTime=new Date).setSeconds(endTime.getSeconds()+32),clickTime=startTime,hitTime=startTime,clickStamps=[],requestAnimationFrame(run)}}function hit(e){if(clicks+=1,"RUNNING"==state){var t,i;"TouchEvent"in window?e instanceof TouchEvent&&(t=e.touches[0].clientX-canvasDiv.offsetLeft,i=e.touches[0].clientY-canvasDiv.offsetTop):e&&(t=e.offsetX,i=e.offsetY);var r=Math.floor((t-t%(cellSize+bSize))/cellSize),a=Math.floor((i-i%(cellSize+bSize))/cellSize);gameMap.includes("".concat(r,".").concat(a))||a>=h||r>=w?(endTime.setMilliseconds(endTime.getMilliseconds()-msToLife),misses+=1,missStreak+=1):(endTime.setMilliseconds(endTime.getMilliseconds()+msToLife),hitTime=new Date,missStreak=0,renderSquare(r,a,fillColor),randomCell(),gameMap.push("".concat(r,".").concat(a))),clickTime=new Date,clickStamps.unshift(clickTime),missStreak>=breakPoint&&gameover(),msToLife>200?msToLife-=.8:msToLife>166?msToLife-=.125:msToLife>142?msToLife-=1/150:msToLife>125&&(msToLife-=.0016)}else start();window.getSelection?window.getSelection().removeAllRanges():document.selection&&document.selection.empty()}render(borderColor,squareColor);var settingsDiv=document.getElementById("settings"),toggleBar=settingsDiv.querySelector("#toggle-bar");toggleBar.addEventListener("click",(function(e){var t=parseInt(healthbarDiv.style.width);healthbarDiv.style.width=t+30>100?"0%":String(t+30)+"%"}));var showInfo=settingsDiv.querySelector("#toggle-info");showInfo.addEventListener("click",(function(e){infoDiv.innerHTML||(addInfo("time","0s"),addInfo("clicks","0"),addInfo("speed","0"),addInfo("accuracy",String(Math.floor(100*accuracy))+"%")),infoDiv.classList.toggle("hidden")}));var firstRound=settingsDiv.querySelector("#show-first-round");firstRound.addEventListener("click",(function(e){infoDiv.classList.add("hidden"),infoDiv.innerHTML="",gameMap=[];for(var t=0;t<h;++t)for(var i=0;i<w;++i)gameMap.push("".concat(i,".").concat(t));render();for(var r=0;r<activeCells;++r)randomCell()})),canvasDiv.addEventListener("touchstart",(function(e){return hit(e),e.preventDefault(),!1})),canvasDiv.addEventListener("mousedown",hit),canvasDiv.parentElement.addEventListener("contextmenu",(function(e){return e.preventDefault(),!1})),document.body.addEventListener("keydown",(function(e){["Space","Escape"].includes(e.code)&&start(!0)})),window.addEventListener("resize",(function(e){"RUNNING"!=state&&(refreshCanvas(),render(borderColor,squareColor))})),"serviceWorker"in navigator&&"file:"!=window.location.protocol&&navigator.serviceWorker.register(new URL("sw.js",location));
//# sourceMappingURL=app.973a4695.js.map
